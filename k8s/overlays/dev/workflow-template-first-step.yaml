apiVersion: argoproj.io/v1alpha1
kind: WorkflowTemplate
metadata:
  name: first-step-workflow-template
  labels:
    tags.datadoghq.com/env: "dev"
spec:
  entrypoint: output-parameter
  templates:
    - name: first-step-job
      serviceAccountName: argocd
      script:
        image: asia-northeast1-docker.pkg.dev/planet-4f7c6/gke-argocd/first-step
        command: [ bash ]
        source: |
          # Assuming that the command outputs JSON to stdout
          ./first-batch > /tmp/number.txt
    - name: output-result
      inputs:
        artifacts:
          - name: number-file
            path: /tmp/number.txt
      container:
        image: busybox
        command: [ cat ]
        args: [ /tmp/number.txt ]